<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Calculadora Multi</title>
  <link rel="icon" type="image/png" href="assets/favicon-96x96.png" sizes="96x96" />
  <link rel="icon" type="image/svg+xml" href="assets/favicon.svg" />
  <link rel="shortcut icon" href="assets/favicon.ico" />
  <link rel="apple-touch-icon" sizes="180x180" href="assets/apple-touch-icon.png" />
  <link rel="manifest" href="assets/site.webmanifest" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg: #0b1220;
      --card: #121a2b;
      --muted: #7e8aa1;
      --text: #e6edf7;
      --accent: #79c0ff;
      --good: #3fb950;
      --warn: #d29922;
      --bad: #f85149;
    }
    * { box-sizing: border-box; }
    html, body {
  height: 100%;
}

body {
  display: flex;
  flex-direction: column;
  margin: 0;
  padding: 24px;
  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Apple Color Emoji, Segoe UI Emoji;
  background: radial-gradient(1200px 600px at 10% -10%, #12213f 0%, #0b1220 50%) no-repeat,
            #0b1220;
background-attachment: fixed;
  color: var(--text);
}

footer {
  background-color: var(--bg);
  padding: 20px 0;
}

footer img {
  display: block;
  margin: auto;
}

    h1 { margin: 0 0 12px; font-size: 28px; line-height: 1.1; text-align:center; }
    p  { margin: 0 0 12px; color: var(--muted); text-align:center; }
    .app {
      max-width: 960px; margin: 0 auto; display: grid; gap: 16px;
      grid-template-columns: 1.2fr 1fr;
    }
    .card {
      background: linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.01));
      border: 1px solid rgba(255,255,255,0.08);
      border-radius: 16px; padding: 16px;
      box-shadow: 0 6px 30px rgba(0,0,0,0.35), inset 0 1px 0 rgba(255,255,255,0.05);
    }
    .full { grid-column: 1 / -1; }
    label { display: block; font-weight: 600; margin-bottom: 6px; }
    input[type="text"] {
      width: 100%; background: #0d1527; color: var(--text);
      border: 1px solid rgba(255,255,255,0.12); border-radius: 10px;
      padding: 12px 14px; font-size: 16px; outline: none;
    }
    .hint { font-size: 12px; color: var(--muted); margin-top: 6px; }
    .row { display: flex; gap: 12px; flex-wrap: wrap; align-items: center; }

    
    .modes, .brands { display: flex; flex-direction: column; gap: 8px; }

    
    .mode, .brand {
      padding: 8px 12px; border-radius: 999px; border: 1px solid rgba(255,255,255,0.12);
      cursor: pointer; user-select: none; color: var(--muted);
      width: fit-content;
    }
    .mode input, .brand input { display: none; }
    .mode.active, .brand.active {
      border-color: var(--accent); color: var(--text);
      box-shadow: 0 0 0 2px rgba(121,192,255,0.2) inset;
    }

    button {
      padding: 12px 16px; border-radius: 10px; border: 1px solid rgba(255,255,255,0.14);
      background: linear-gradient(180deg, #184a78, #103659);
      color: white; font-weight: 600; cursor: pointer;
    }
    button.secondary { background: #0f1b33; }
    pre, code { white-space: pre-wrap; word-wrap: break-word; }

    .result-line { display: flex; gap: 12px; justify-content: space-between; align-items: baseline; padding: 10px 0; border-bottom: 1px dashed rgba(255,255,255,0.08); }
    .result-line:last-child { border-bottom: none; }
    .tag { font-size: 12px; padding: 4px 8px; background: rgba(255,255,255,0.08); border-radius: 999px; color: var(--muted); }
    .chip { font-size: 12px; padding: 4px 8px; border-radius: 999px; }
    .ok { background: rgba(63,185,80,0.15); color: var(--good); border: 1px solid rgba(63,185,80,0.25); }
    .no { background: rgba(248,81,73,0.15); color: var(--bad); border: 1px solid rgba(248,81,73,0.25); }
    .warn { background: rgba(210,153,34,0.15); color: var(--warn); border: 1px solid rgba(210,153,34,0.25); }
    .muted { color: var(--muted); }

    .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
    @media (max-width: 880px) {
      .app { grid-template-columns: 1fr; }
      .grid { grid-template-columns: 1fr; }
    }
    .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace; }
  </style>
</head>
<body>
  <h1>Calculadora de Condensadoras Multi</h1>
  <p style="color: #0b1220;">A glória é de Deus</p>

  <div class="app">
    <div class="card">
      <label for="evaps">Evaporadoras</label>
      <input id="evaps" type="text" placeholder="Ex.: 7,7,12,24" />
      <div class="hint">Aceita 1 a 5 itens. Valores válidos: 7, 9, 12, 18, 24.</div>

      <div style="height: 12px"></div>

      
      <div class="grid">
        <div>
          <label>Modo de simultaneidade</label>
          <div id="modes" class="modes">
            <label class="mode active"><input type="radio" name="modo" value="residencial" checked>Residencial (até 140%)</label>
            <label class="mode"><input type="radio" name="modo" value="corporativo">Corporativo (até 110%)</label>
            <label class="mode"><input type="radio" name="modo" value="maximo">Capacidade Máxima</label>
          </div>
        </div>

        <div>
          <label>Marca</label>
<div id="brands" class="brands">
  <label class="brand active"><input type="radio" name="marca" value="todas" checked>Todas as marcas</label>
  <div style="display: flex; gap: 8px;">
    <label class="brand"><input type="radio" name="marca" value="lg">LG</label>
    <label class="brand"><input type="radio" name="marca" value="daikin">Daikin</label>
  </div>
  <label class="brand"><input type="radio" name="marca" value="samsung">Samsung</label>
</div>
        </div>
      </div>

      <div style="height: 12px"></div>

      <div class="row">
        <button id="btnVer">Verificar</button>
        <button id="btnLimpar" class="secondary">Limpar</button>
      </div>
    </div>

    <div class="card">
      <label>Resultado</label>
      <div id="resultado" class="mono" style="min-height: 120px;">
        <span class="muted">— Sem resultados ainda —</span>
      </div>
    </div>

    <div class="card full">
      <label>Detalhes</label>
      <div id="detalhes" class="mono"><span class="muted">Quando você buscar, os cálculos e limites aparecem aqui.</span></div>
    </div>
  </div>

  <script>
    const norm = arr => [...arr].sort((a,b)=>a-b).join(',');
    const soma = arr => arr.reduce((t,n)=>t+n,0);

    function capEfetiva(modelo, modo) {
      const { capNominal, capMax } = modelo;
      if (modo === 'residencial') return Math.min(capNominal * 1.4, capMax);
      if (modo === 'corporativo') return Math.min(capNominal * 1.1, capMax);
      return capMax;
    }

    function porcento(v) { return (Math.round(v * 10) / 10).toString().replace('.', ','); }

    function parseEntrada(txt) {
      if (!txt || !txt.trim()) return [];
      return txt.split(',')
        .map(x => parseInt(x.trim(), 10))
        .filter(x => [7,9,12,18,24].includes(x))
        .slice(0, 5);
    }

    function criarModeloDaikin(nome, capNominal, capMax, lista) {
      return {
        nome,
        modelo: nome.split(' ')[1],
        capNominal,
        capMax,
        combinacoes: new Set(lista.map(v => norm(v)))
      };
    }

    const DAIKIN_18_BI = criarModeloDaikin('Daikin 18 Bi', 18, 24, [
      [9, 9],
      [9, 12],
      [12, 12]
    ]);

    const DAIKIN_18_TRI = criarModeloDaikin('Daikin 18 Tri', 18, 30, [
      [9, 9],
      [9, 12],
      [9, 18],
      [12, 12],
      [12, 18],
      [9, 9, 9],
      [9, 9, 12]
    ]);

    const DAIKIN_24 = criarModeloDaikin('Daikin 24', 24, 38, [
      [9, 9], [9, 12], [9, 18],
      [12, 12], [12, 18], [9, 9, 9], [9, 9, 12],
      [9, 20], [12, 20], [18, 18], [18, 20],
      [9, 9, 18], [9, 9, 20], [9, 12, 12], [9, 12, 18], [12, 12, 12]
    ]);

    const DAIKIN_28 = criarModeloDaikin('Daikin 28', 28, 45, [
      [9, 9], [9, 12], [9, 18],
      [12, 12], [12, 18], [9, 9, 9], [9, 9, 12],
      [9, 20], [12, 20], [18, 18], [18, 20],
      [9, 9, 18], [9, 9, 20], [9, 12, 12], [9, 12, 18], [12, 12, 12],
      [9, 24], [12, 24], [18, 24], [20, 20], [20, 24],
      [9, 9, 24], [9, 12, 20], [9, 12, 24], [9, 18, 18], [9, 18, 20], [9, 20, 20],
      [12, 12, 18], [12, 12, 20], [12, 12, 24], [12, 18, 18], [12, 18, 20],
      [9, 9, 9, 9], [9, 9, 9, 12], [9, 9, 9, 18], [9, 9, 9, 20],
      [9, 9, 12, 12], [9, 9, 12, 18], [9, 9, 12, 20],
      [9, 12, 12, 12], [9, 12, 12, 18], [12, 12, 12, 12]
    ]);

    const DAIKIN_34 = criarModeloDaikin('Daikin 34', 34, 54, [
      [9, 9], [9, 12], [9, 18],
      [12, 12], [12, 18], [9, 9, 9], [9, 9, 12],
      [9, 20], [12, 20], [18, 18], [18, 20],
      [9, 9, 18], [9, 9, 20], [9, 12, 12], [9, 12, 18], [12, 12, 12],
      [9, 24], [12, 24], [18, 24], [20, 20], [20, 24],
      [9, 9, 24], [9, 12, 20], [9, 12, 24], [9, 18, 18], [9, 18, 20], [9, 20, 20],
      [12, 12, 18], [12, 12, 20], [12, 12, 24], [12, 18, 18], [12, 18, 20],
      [9, 9, 9, 9], [9, 9, 9, 12], [9, 9, 9, 18], [9, 9, 9, 20],
      [9, 9, 12, 12], [9, 9, 12, 18], [9, 9, 12, 20],
      [9, 12, 12, 12], [9, 12, 12, 18], [12, 12, 12, 12],
      [9, 18, 24], [9, 20, 24], [12, 18, 24], [12, 20, 20], [18, 18, 18],
      [9, 9, 9, 24], [9, 9, 12, 24], [9, 9, 18, 18], [9, 12, 12, 20], [12, 12, 12, 18]
    ]);

    const DAIKIN_38 = criarModeloDaikin('Daikin 38', 38, 60, [
      [9, 9], [9, 12], [9, 18],
      [12, 12], [12, 18], [9, 9, 9], [9, 9, 12],
      [9, 20], [12, 20], [18, 18], [18, 20],
      [9, 9, 18], [9, 9, 20], [9, 12, 12], [9, 12, 18], [12, 12, 12],
      [9, 24], [12, 24], [18, 24], [20, 20], [20, 24],
      [9, 9, 24], [9, 12, 20], [9, 12, 24], [9, 18, 18], [9, 18, 20], [9, 20, 20],
      [12, 12, 18], [12, 12, 20], [12, 12, 24], [12, 18, 18], [12, 18, 20],
      [9, 9, 9, 9], [9, 9, 9, 12], [9, 9, 9, 18], [9, 9, 9, 20],
      [9, 9, 12, 12], [9, 9, 12, 18], [9, 9, 12, 20],
      [9, 12, 12, 12], [9, 12, 12, 18], [12, 12, 12, 12],
      [9, 18, 24], [9, 20, 24], [12, 18, 24], [12, 20, 20], [18, 18, 18],
      [9, 9, 9, 24], [9, 9, 12, 24], [9, 9, 18, 18], [9, 12, 12, 20], [12, 12, 12, 18],
      [24, 24],
      [9, 9, 9, 9, 9], [9, 9, 9, 9, 12], [9, 9, 9, 9, 18], [9, 9, 9, 12, 12], [9, 9, 12, 12, 12]
    ]);

    const DAIKIN_MODELOS = [
      DAIKIN_18_BI, DAIKIN_18_TRI, DAIKIN_24, DAIKIN_28, DAIKIN_34, DAIKIN_38
    ];

    const LG_MODELOS_INFO = [
      { nome: 'LG 18', capNominal: 18, capMax: 24, maxEvaps: 2 },
      { nome: 'LG 21', capNominal: 21, capMax: 30, maxEvaps: 3 },
      { nome: 'LG 24', capNominal: 24, capMax: 36, maxEvaps: 3 },
      { nome: 'LG 30', capNominal: 30, capMax: 51, maxEvaps: 4 },
      { nome: 'LG 36', capNominal: 36, capMax: 54, maxEvaps: 5 },
      { nome: 'LG 48', capNominal: 48, capMax: 72, maxEvaps: 5 },
    ];
    const LG_EVAPS = [7, 9, 12, 18, 24];

    function gerarCombinacoesLG(capMax, maxEvaps) {
      let res = new Set();
      function comb(atual) {
        const somaAtual = soma(atual);
        if (atual.length > 0 && somaAtual <= capMax && atual.length <= maxEvaps) {
          res.add(norm(atual));
        }
        if (atual.length >= maxEvaps) return;
        for (let cap of LG_EVAPS) {
          if (somaAtual + cap <= capMax) {
            comb([...atual, cap].sort((a,b) => a-b));
          }
        }
      }
      comb([]);
      return res;
    }

    const LG_MODELOS = LG_MODELOS_INFO.map(info => ({
      nome: info.nome,
      modelo: info.nome.split(' ')[1],
      capNominal: info.capNominal,
      capMax: info.capMax,
      combinacoes: gerarCombinacoesLG(info.capMax, info.maxEvaps)
    }));

    const SAMSUNG_18 = {
      nome: 'Samsung 18',
      modelo: '18',
      capNominal: 18,
      capMax: 30,
      combinacoes: new Set([
        norm([7,7]), norm([7,9]), norm([7,12]), norm([7,18]),
        norm([9,9]), norm([9,12]), norm([9,18]),
        norm([12,12]), norm([12,18]),
      ])
    };

    const SAMSUNG_24 = {
      nome: 'Samsung 24',
      modelo: '24',
      capNominal: 24,
      capMax: 39,
      combinacoes: new Set([
        norm([7,7]), norm([7,9]), norm([7,12]), norm([7,18]),
        norm([9,9]), norm([9,12]), norm([9,18]),
        norm([12,12]), norm([12,18]), norm([18,18]),
        norm([7,7,7]), norm([7,7,9]), norm([7,7,12]), norm([7,7,18]),
        norm([7,9,9]), norm([7,9,12]), norm([7,9,18]),
        norm([7,12,12]), norm([7,12,18]),
        norm([9,9,9]), norm([9,9,12]), norm([9,9,18]),
        norm([9,12,12]), norm([9,12,18]),
        norm([12,12,12]),
      ])
    };

    const SAMSUNG_28 = {
      nome: 'Samsung 28',
      modelo: '28',
      capNominal: 28,
      capMax: 48,
      combinacoes: new Set([
        norm([7,7]), norm([7,9]), norm([7,12]), norm([7,18]), norm([7,24]),
        norm([9,9]), norm([9,12]), norm([9,18]), norm([9,24]),
        norm([12,12]), norm([12,18]), norm([12,24]),
        norm([18,18]), norm([18,24]),
        norm([7,7,7]), norm([7,7,9]), norm([7,7,12]), norm([7,7,18]), norm([7,7,24]),
        norm([7,9,9]), norm([7,9,12]), norm([7,9,18]), norm([7,9,24]),
        norm([7,12,12]), norm([7,12,18]), norm([7,18,18]),
        norm([9,9,9]), norm([9,9,12]), norm([9,9,18]), norm([9,9,24]),
        norm([9,12,12]), norm([9,12,18]),
        norm([12,12,12]), norm([12,12,18]),
        norm([7,7,7,7]), norm([7,7,7,9]), norm([7,7,7,12]), norm([7,7,7,18]),
        norm([7,7,9,9]), norm([7,7,9,12]), norm([7,7,9,18]), norm([7,7,12,12]),
        norm([7,9,9,9]), norm([7,9,9,12]), norm([7,9,9,18]), norm([7,9,12,12]),
        norm([9,9,9,9]), norm([9,9,9,12]), norm([9,9,12,12]),
        norm([12,12,12,12]), norm([9,9,12,18]),
      ])
    };

    const combinacoesCondensadora34 = [
      [7,7],[7,9],[7,12],[7,18],[7,24],[9,9],[9,12],[9,18],[9,24],
      [12,12],[12,18],[12,24],[18,18],[18,24],[24,24],
      [7,7,7],[7,7,9],[7,7,12],[7,7,18],[7,7,24],[7,9,9],[7,9,12],[7,9,18],[7,9,24],
      [7,12,12],[7,12,18],[7,12,24],[7,18,18],[7,18,24],[7,24,24],
      [9,9,9],[9,9,12],[9,9,18],[9,9,24],[9,12,12],[9,12,18],[9,12,24],
      [9,18,18],[9,18,24],[9,24,24],[12,12,12],[12,12,18],[12,12,24],
      [12,18,18],[12,18,24],[12,24,24],[18,18,18],[18,18,24],
      [7,7,7,7],[7,7,7,9],[7,7,7,12],[7,7,7,18],[7,7,7,24],
      [7,7,9,9],[7,7,9,12],[7,7,9,18],[7,7,9,24],
      [7,7,12,12],[7,7,12,18],[7,7,12,24],[7,7,18,18],[7,7,18,24],
      [7,9,9,9],[7,9,9,12],[7,9,9,18],[7,9,9,24],[7,9,12,12],[7,9,12,18],[7,9,12,24],
      [7,9,18,18],[7,9,18,24],[7,12,12,12],[7,12,12,18],[7,12,12,24],[7,12,18,18],[7,12,18,24],[7,18,18,18],
      [9,9,9,9],[9,9,9,12],[9,9,9,18],[9,9,9,24],[9,9,12,12],[9,9,12,18],[9,9,12,24],[9,9,18,18],[9,9,18,24],
      [9,12,12,12],[9,12,12,18],[9,12,12,24],[9,12,18,18],
      [12,12,12,12],[12,12,12,18],[12,12,12,24],[12,12,18,18],
      [7,7,7,7,7],[7,7,7,7,9],[7,7,7,7,12],[7,7,7,7,18],[7,7,7,7,24],
      [7,7,7,9,9],[7,7,7,9,12],[7,7,7,9,18],[7,7,7,9,24],
      [7,7,7,12,12],[7,7,7,12,18],[7,7,7,12,24],[7,7,7,18,18],
      [7,7,9,9,9],[7,7,9,9,12],[7,7,9,9,18],[7,7,9,9,24],
      [7,7,9,12,12],[7,7,9,12,18],[7,7,9,12,24],[7,7,9,18,18],
      [7,7,12,12,12],[7,7,12,12,18],[7,9,9,9,9],[7,9,9,9,12],[7,9,9,9,18],[7,9,9,9,24],
      [7,9,9,12,12],[7,9,9,12,18],[7,9,9,12,24],[7,9,9,18,18],
      [7,9,12,12,12],[7,9,12,12,18],[7,12,12,12,12],
      [9,9,9,9,9],[9,9,9,9,12],[9,9,9,9,18],[9,9,9,9,24],[9,9,9,12,12],[9,9,9,12,18],
      [9,9,12,12,12],[9,9,12,12,18],[9,12,12,12,12],
    ];

    const SAMSUNG_34 = {
      nome: 'Samsung 34',
      modelo: '34',
      capNominal: 34,
      capMax: 60,
      combinacoes: new Set(combinacoesCondensadora34.map(v => norm(v)))
    };

    const combinacoesCondensadora48 = [
      [7,7],[7,9],[7,12],[7,18],[7,24],[9,9],[9,12],[9,18],[9,24],
      [12,12],[12,18],[12,24],[18,18],[18,24],[24,24],
      [7,7,7],[7,7,9],[7,7,12],[7,7,18],[7,7,24],[7,9,9],[7,9,12],[7,9,18],[7,9,24],
      [7,12,12],[7,12,18],[7,12,24],[7,18,18],[7,18,24],[7,24,24],
      [9,9,9],[9,9,12],[9,9,18],[9,9,24],[9,12,12],[9,12,18],[9,12,24],
      [9,18,18],[9,18,24],[9,24,24],[12,12,12],[12,12,18],[12,12,24],
      [12,18,18],[12,18,24],[12,24,24],[18,18,18],[18,18,24],
      [7,7,7,7],[7,7,7,9],[7,7,7,12],[7,7,7,18],[7,7,7,24],
      [7,7,9,9],[7,7,9,12],[7,7,9,18],[7,7,9,24],
      [7,7,12,12],[7,7,12,18],[7,7,12,24],[7,7,18,18],[7,7,18,24],
      [7,9,9,9],[7,9,9,12],[7,9,9,18],[7,9,9,24],[7,9,12,12],[7,9,12,18],[7,9,12,24],
      [7,9,18,18],[7,9,18,24],[7,12,12,12],[7,12,12,18],[7,12,12,24],[7,12,18,18],[7,12,18,24],[7,18,18,18],
      [9,9,9,9],[9,9,9,12],[9,9,9,18],[9,9,9,24],[9,9,12,12],[9,9,12,18],[9,9,12,24],[9,9,18,18],[9,9,18,24],
      [9,12,12,12],[9,12,12,18],[9,12,12,24],[9,12,18,18],[9,18,18,18],
      [12,12,12,12],[12,12,12,18],[12,12,12,24],[12,12,18,18],
      [7,7,7,7,7],[7,7,7,7,9],[7,7,7,7,12],[7,7,7,7,18],[7,7,7,7,24],
      [7,7,7,9,9],[7,7,7,9,12],[7,7,7,9,18],[7,7,7,9,24],
      [7,7,7,12,12],[7,7,7,12,18],[7,7,7,12,24],[7,7,7,18,18],
      [7,7,9,9,9],[7,7,9,9,12],[7,7,9,9,18],[7,7,9,9,24],
      [7,7,9,12,12],[7,7,9,12,18],[7,7,9,12,24],[7,7,9,18,18],
      [7,7,12,12,12],[7,7,12,12,18],[7,7,12,18,18],
      [7,9,9,9,9],[7,9,9,9,12],[7,9,9,9,18],[7,9,9,9,24],
      [7,9,9,12,12],[7,9,9,12,18],[7,9,9,12,24],[7,9,9,18,18],
      [7,9,12,12,12],[7,9,12,12,18],[7,12,12,12,12],
      [9,9,9,9,9],[9,9,9,9,12],[9,9,9,9,18],[9,9,9,9,24],[9,9,9,12,12],[9,9,9,12,18],[9,9,9,18,18],
      [9,9,12,12,12],[9,9,12,12,18],[9,12,12,12,12],[12,12,12,12,12],[9,12,12,12,12],[12,12,12,12,12],
    ];

    const SAMSUNG_48 = {
      nome: 'Samsung 48',
      modelo: '48',
      capNominal: 48,
      capMax: 69,
      combinacoes: new Set(combinacoesCondensadora48.map(v => norm(v)))
    };

    let MODELOS = [
      SAMSUNG_18, SAMSUNG_24, SAMSUNG_28, SAMSUNG_34, SAMSUNG_48,
      ...LG_MODELOS,
      ...DAIKIN_MODELOS
    ];

    function isDaikin(modelo) {
      return modelo.nome.toLowerCase().startsWith('daikin');
    }

    function keyParaModelo(modelo, entrada) {
      const arr = isDaikin(modelo) ? entrada.map(v => v === 7 ? 9 : v) : entrada;
      return norm(arr);
    }

    function verificar() {
      const entradaOriginal = parseEntrada(document.getElementById('evaps').value);
      const res = document.getElementById('resultado');
      const det = document.getElementById('detalhes');

      if (entradaOriginal.length === 0) {
        res.innerHTML = `<span class="muted">Informe ao menos uma evaporadora (7, 9, 12, 18, 24).</span>`;
        det.innerHTML = `<span class="muted">—</span>`;
        return;
      }

      const total = soma(entradaOriginal);
      const modo = document.querySelector('input[name="modo"]:checked').value;
      const marcaSelecionada = document.querySelector('input[name="marca"]:checked').value;

      let tag7 = '';
      if (entradaOriginal.includes(7)) {
        if (marcaSelecionada === 'daikin') tag7 = ' - 7 tratado como 9';
        else if (marcaSelecionada === 'todas') tag7 = ' - 7 tratado como 9 para Daikin';
      }

      const resultados = MODELOS.map(m => {
        const keyModelo = keyParaModelo(m, entradaOriginal);
        const existeNaTabela = m.combinacoes.has(keyModelo);
        const limite = capEfetiva(m, modo);
        const ocupa = total / limite * 100;
        const cabeNoLimite = total <= limite + 1e-9;
        return { modelo: m, existeNaTabela, limite, cabeNoLimite, ocupa };
      });

      const compativeis = resultados.filter(r => r.existeNaTabela && r.cabeNoLimite);
      let htmlResultado = "";

      if (marcaSelecionada === "todas") {
        const marcas = [...new Set(MODELOS.map(m => m.nome.split(' ')[0]))];
        marcas.forEach(marca => {
          const melhor = compativeis
            .filter(r => r.modelo.nome.toLowerCase().startsWith(marca.toLowerCase()))
            .sort((a, b) => a.modelo.capNominal - b.modelo.capNominal)[0];

          if (melhor) {
            htmlResultado += `
              <div class="result-line">
                <div>
                  <strong>${marca} ideal:</strong> ${melhor.modelo.nome}
                  <span class="tag">nominal ${melhor.modelo.capNominal}</span>
                  <span class="tag">máx ${melhor.modelo.capMax}</span>
                </div>
                <div class="chip ok">Simultaneidade: ${porcento((total / melhor.modelo.capNominal) * 100)}%</div>
              </div>
            `;
          } else {
            htmlResultado += `
              <div class="result-line">
                <div><strong>${marca}:</strong> Nenhuma condensadora compatível</div>
                <div class="chip no">Incompatível</div>
              </div>
            `;
          }
        });
      } else {
        const melhor = compativeis
          .filter(r => r.modelo.nome.toLowerCase().startsWith(marcaSelecionada.toLowerCase()))
          .sort((a, b) => a.modelo.capNominal - b.modelo.capNominal)[0];

        if (melhor) {
          htmlResultado += `
            <div class="result-line">
              <div>
                <strong>Condensadora ideal:</strong> ${melhor.modelo.nome}
                <span class="tag">nominal ${melhor.modelo.capNominal}</span>
                <span class="tag">máx ${melhor.modelo.capMax}</span>
              </div>
              <div class="chip ok">Simultaneidade: ${porcento((total / melhor.modelo.capNominal) * 100)}%</div>
            </div>
          `;
        } else {
          htmlResultado += `
            <div class="result-line">
              <div><strong>Nenhuma condensadora é compatível</strong></div>
              <div class="chip no">Incompatível</div>
            </div>
          `;
        }
      }

      res.innerHTML = htmlResultado;

      const linhas = resultados
  .filter(r => {
    if (marcaSelecionada === "todas") return true;
    return r.modelo.nome.toLowerCase().startsWith(marcaSelecionada.toLowerCase());
  })
  .map(r => {
    const mark = r.existeNaTabela ? '✔' : '✖';
    const classe = r.existeNaTabela ? (r.cabeNoLimite ? 'ok' : 'warn') : 'no';
    const label = r.existeNaTabela ? (r.cabeNoLimite ? 'Compatível' : 'Ultrapassa limite') : 'Combinação não listada';
    const simult = (total / r.modelo.capNominal) * 100;
    return `
      <div class="result-line">
        <div>
          ${mark} ${r.modelo.nome}
          <span class="tag">nominal ${r.modelo.capNominal}</span>
          <span class="tag">máx ${r.modelo.capMax}</span>
          <span class="tag">limite (${modo}) = ${r.limite}</span>
        </div>
        <div class="chip ${classe}">${label} — Simultaneidade: ${porcento(simult)}%</div>
      </div>
    `;
  })
  .join('');

  det.innerHTML = `
  <div class="grid">
    <div>
      <strong>Entrada normalizada:</strong> [${entradaOriginal.slice().sort((a, b) => a - b).join(', ')}]
      ${tag7 ? `<div class="muted">${tag7.replace(/^ - /, '')}</div>` : ''}
    </div>
    <div><strong>Soma das evaporadoras:</strong> ${total}</div>
  </div>
        <div style="height:8px"></div>
        ${linhas}
      `;
    }

    document.getElementById('btnVer').addEventListener('click', verificar);
    document.getElementById('btnLimpar').addEventListener('click', () => {
      document.getElementById('evaps').value = '';
      document.getElementById('resultado').innerHTML = `<span class="muted">— Sem resultados ainda —</span>`;
      document.getElementById('detalhes').innerHTML = `<span class="muted">Quando você buscar, os cálculos e limites aparecem aqui.</span>`;
    });

    document.querySelectorAll('#modes .mode').forEach(lbl => {
      lbl.addEventListener('click', () => {
        document.querySelectorAll('#modes .mode').forEach(x => x.classList.remove('active'));
        lbl.classList.add('active');
        lbl.querySelector('input').checked = true;
      });
    });
    document.querySelectorAll('#brands .brand').forEach(lbl => {
      lbl.addEventListener('click', () => {
        document.querySelectorAll('#brands .brand').forEach(x => x.classList.remove('active'));
        lbl.classList.add('active');
        lbl.querySelector('input').checked = true;
      });
    });
  </script>
<footer style="text-align:center; margin-top: 20px;">
  <img src="assets/logo.png" alt="Minha imagem" style="max-width: 50px;">
</footer>
</body>
</html>
